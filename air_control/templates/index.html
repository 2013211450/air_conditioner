{% extends 'base.html' %}
{% block main_text %}
    <script type="text/javascript">
        function set_address(){
            $.post("/settings/", {
                host: $("#host").val(),
            }, function(data) {
                var answer = confirm(data['reason']);
                if (answer) {
                    location.reload(true);
                }
            }, "json");
            //location.reload(true)
        }
        function update(){
            var table = document.getElementById("room_table");
            table.style.display = 'none';
            var my_input = document.getElementById("my_input");
            my_input.style.display = 'block';
        }

    </script>
	<div><p></p></div></br></br>
    <div class="row">
        <div id="room_table" class="container" style="display: block">
            <div><h3>主机地址: {{ room.host }}</h3></div>
            <div><button class="btn btn-primary" onclick="update()">修改主机地址</button></div>
        </div>
        <div class="container" id="my_input" style="display: none">
            <input id="host" name="host" maxlength="30" class="kari-nav-input" type="text" placeholder="127.0.0.1:8000" />
            <button type="submit" id="sub" class="btn btn-primary" onclick="set_address()">确认</button>
        </div>
    </div></br>
    <div class="container">
		<div class="row">
			<div class="col-xs-8">
				<div class="container">
					<div><h3>空调信息</h3></div>
					<div class="list-inline">
						<li><p>风速: {{ room.speed }}</p></li>
						<li><p>模式:{{ room.mode }}</p></li>
					</div>
					<div>
						<p><font face="verdana" size=30>17.3°C</font></p>
					</div>
				</div>
			</div>
			<div class="col-xs-4">
				<div class="container-fluid">
					<div><h3 style="text-align:center">操作</h3></div>
					<div>
						<button class="btn btn-default pull-left" onclick="post_to('/operator/', {'temperature':0.1})">升温</button>
						<button class="btn btn-default pull-right" onclick="post_to('/operator/', {'temperature':-0.1})">降温</button>
					</div></br>
					<div><p></p></div></br>
					<div>
						<button class="btn btn-default pull-left" onclick="post_to('/operator/', {'speed':1})">风速</button>
						<button class="btn btn-default pull-right" onclick="post_to('/operator/', {'status':1})">模式</button>
					</div></br>
				</div>
			</div>
		</div>
        <div id="data_line" style="width: 600px;height:400px;"></div>
        <script type="text/javascript">
            function randomData() {
                now = new Date(+now + oneSecond);
                value = value + Math.random() * 21 - 10;
                return {
                    name: now.toString(),
                    value: Math.round(value)
                        //[now.getHours(), now.getMinutes(), now.getSeconds()].join(':'),
                }
            }
            var data = [];
            var now = new Date(2007, 9, 3, 12, 59, 59);
            var oneDay = 24 * 3600 * 1000;
            var oneSecond = 1000 * 3600;
            var value = Math.random() * 1000;
            var myChart = echarts.init(document.getElementById("data_line"));
            for (var i = 0; i < 1000; i++) {
                data.push(randomData());
            }

            var option = {
                title: {
                    text: '动态数据 + 时间坐标轴'
                },
                tooltip: {
                    trigger: 'axis',
                    formatter: function (params) {
                        params = params[0];
                        return params.name + ':' + params.value[1];
                    },
                    axisPointer: {
                        animation: false
                    }
                },
                xAxis: {
                    type: 'time',
                    splitLine: {
                        show: false
                    }
                },
                yAxis: {
                    type: 'value',
                    boundaryGap: [0, '100%'],
                    splitLine: {
                        show: false
                    }
                },
                series: [{
                    name: '模拟数据',
                    type: 'line',
                    showSymbol: false,
                    hoverAnimation: false,
                    data: data
                }]
            };
            myChart.setOption(option);
            /*
            setInterval(function () {
                data.shift();
                data.push(randomData());
                option.series[0].data = data
                myChart.setOption(option);

            }, 1000);
            */
        </script>
    </div>

{% endblock %}
